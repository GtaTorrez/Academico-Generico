<div class="menu-top" fxLayout="row">
  <div fxLayout="column" fxFlex="50%" fxLayoutAlign="start start">
    <form>
      <div fxLayout="row" fxLayoutAlign="end end">
        <div fxLayout="column">
          <div fxLayout="row">
            <mat-form-field>
              <input matInput [matDatepicker]="myDatepicker1" [(ngModel)]="fechaDesde" placeholder="Desde (dia/mes/año)" (dateChange)="actualizarTablaAsistencias()" name="fechaDesde" readonly>
              <mat-datepicker-toggle matSuffix [for]="myDatepicker1"></mat-datepicker-toggle>
              <mat-datepicker #myDatepicker1 startView="month"></mat-datepicker>
            </mat-form-field>
            <div style="width:10px"></div>
            <mat-form-field>
              <input matInput [matDatepicker]="myDatepicker2" [(ngModel)]="fechaHasta" placeholder="Hasta (dia/mes/año)" (dateChange)="actualizarTablaAsistencias()" name="fechaHasta" readonly>
              <mat-datepicker-toggle matSuffix [for]="myDatepicker2"></mat-datepicker-toggle>
              <mat-datepicker #myDatepicker2 startView="month"></mat-datepicker>
            </mat-form-field>
          </div>
          <div fxLayout="row">
              <mat-form-field>
                <mat-select placeholder="Turno" [(value)]="idTurno" (selectionChange)="actualizarSelectorGrados()">
                  <mat-option *ngFor="let turno of turnos" [value]="turno.id">{{turno.nombre}}</mat-option>
                </mat-select>
              </mat-form-field>
              <div style="width:10px"></div>
              <mat-form-field>
                <mat-select placeholder="Grado" [(value)]="idGrado" (selectionChange)="actualizarSelectorGrupos()">
                  <mat-option *ngFor="let grado of grados" [value]="grado.id">{{grado.nombre}}</mat-option>
                </mat-select>
              </mat-form-field>
              <div style="width:10px"></div>
              <mat-form-field>
                <mat-select placeholder="Grupo" [(value)]="idGrupo" (selectionChange)="actualizarSelectorParalelos()">
                  <mat-option *ngFor="let grupo of grupos" [value]="grupo.id">{{grupo.nombre}}</mat-option>
                </mat-select>
              </mat-form-field>
              <div style="width:10px"></div>
              <mat-form-field>
                <mat-select placeholder="Paralelo" [(value)]="idParalelo" (selectionChange)="actualizarTablaAsistencias()">
                  <mat-option *ngFor="let paralelo of paralelos" [value]="paralelo.id">{{paralelo.nombre}}</mat-option>
                </mat-select>
              </mat-form-field>
          </div>
        </div>
      </div>
    </form>
   </div>
</div>
<div class="menu-top" fxLayout="row">
   <div fxLayout="column" fxFlex="100%" fxLayoutAlign="start start">
    <div fxLayout="row" fxLayoutAlign="end end">
      <button type="button" mat-raised-button color="primary" (click)="reporteGeneralEXCEL()">
        <svg viewBox="0 0 551 551" focusable="false" height="20px">
          <path d="M488.432,197.019h-13.226v-63.816c0-0.398-0.063-0.799-0.111-1.205c-0.021-2.531-0.833-5.021-2.568-6.992L366.325,3.694c-0.032-0.031-0.063-0.042-0.085-0.076c-0.633-0.707-1.371-1.295-2.151-1.804c-0.231-0.155-0.464-0.285-0.706-0.422c-0.676-0.366-1.393-0.675-2.131-0.896c-0.2-0.053-0.38-0.135-0.58-0.188C359.87,0.119,359.037,0,358.193,0H97.2c-11.918,0-21.6,9.693-21.6,21.601v175.413H62.377c-17.049,0-30.873,13.818-30.873,30.873v160.545c0,17.038,13.824,30.87,30.873,30.87h13.224V529.2c0,11.907,9.682,21.601,21.6,21.601h356.4c11.907,0,21.6-9.693,21.6-21.601V419.302h13.226c17.044,0,30.871-13.827,30.871-30.87v-160.54C519.297,210.832,505.48,197.019,488.432,197.019z M97.2,21.601h250.193v110.51c0,5.967,4.841,10.8,10.8,10.8h95.407v54.108H97.2V21.601z M339.562,354.344v31.324H236.509V220.704h37.46v133.64H339.562z M74.25,385.663l47.73-83.458l-46.019-81.501h42.833l14.439,30.099c4.899,10.03,8.572,18.116,12.49,27.414h0.483c3.926-10.529,7.101-17.872,11.259-27.414l13.954-30.099h42.588l-46.509,80.525l48.961,84.438h-43.081l-14.929-29.858c-6.115-11.507-10.036-20.07-14.684-29.615h-0.49c-3.431,9.55-7.583,18.119-12.722,29.615l-13.711,29.858H74.25V385.663z M453.601,523.353H97.2V419.302h356.4V523.353z M401.963,388.125c-18.837,0-37.446-4.904-46.738-10.04l7.578-30.839c10.04,5.136,25.46,10.283,41.375,10.283c17.139,0,26.188-7.099,26.188-17.867c0-10.283-7.831-16.157-27.659-23.256c-27.411-9.55-45.282-24.722-45.282-48.718c0-28.15,23.498-49.684,62.427-49.684c18.594,0,32.305,3.927,42.093,8.322l-8.322,30.109c-6.607-3.186-18.361-7.834-34.509-7.834c-16.152,0-23.983,7.338-23.983,15.913c0,10.525,9.291,15.18,30.591,23.258c29.125,10.769,42.836,25.936,42.836,49.191C468.545,364.627,447.257,388.125,401.963,388.125z" fill="currentColor"></path>
        </svg>
         Reporte General (Excel)</button>
      <div style="width:10px"></div>
      <button type="button" mat-raised-button color="primary" (click)="reporteGeneralPDF()"><mat-icon>picture_as_pdf</mat-icon> Reporte General (PDF)</button>
    </div>
  </div>
</div>
<div style="height:10px"></div>
<mat-progress-bar color="primary" [mode]="loadingMode" value="0"></mat-progress-bar>
<div class="container">
        <table class="master" cellspacing="0" cellpadding ="0">
          <thead class="master">
            <tr class="master">
              <th class="master" style="width:300px;border-right: solid lightgrey 1px">
                    <table class="child" cellspacing="0" cellpading="0" border="0" style="margin:0px;float:left">
                      <tr>
                        <td style="width:40px"> N° </td>
                        <td style="width:240px;text-align:left"> Nombre </td>
                      </tr>
                      <tr>
                        <td style="height:20px"></td>
                        <td style="height:20px"></td>
                      </tr>
                    </table>
              </th>
              <th class="master" [ngStyle]="{'width':(listaFechas.length * 43)+'px'}">
                <table class="child" cellspacing="0" cellpading="0" border="0" style="margin:0px;float:left">
                    <tr>
                      <td *ngFor="let itemMes of listaMeses"  [attr.colspan]="itemMes.nroDias" style="text-align:left;border-right:solid lightgrey 1px;white-space:nowrap">{{itemMes.nombre}}</td>
                    </tr>
                    <tr>
                      <td *ngFor="let itemDia of listaFechas" style="width:40px;min-width:40px;max-width:40px;border-right:solid lightgrey 1px;border-top:solid lightgrey 1px">{{itemDia.nroDia}}</td>
                    </tr>
                  </table>
              </th>
              <th class="master" style="width:230px">
                    <table class="child" cellspacing="0" cellpading="0" border="0" style="margin:0px;float:left">
                      <tr>
                        <td colspan="3" style="text-align:center;border-right:solid lightgrey 1px">Total</td>
                        <td colspan="1" style="text-align:center">Reporte</td>
                      </tr>
                      <tr>
                        <td style="width:40px;border-right:solid lightgrey 1px;border-top:solid lightgrey 1px">As</td>
                        <td style="width:40px;border-right:solid lightgrey 1px;border-top:solid lightgrey 1px">Li</td>
                        <td style="width:40px;border-right:solid lightgrey 1px;border-top:solid lightgrey 1px">Fa</td>
                        <td style="width:80px"></td>
                      </tr>
                    </table>
              </th>
            </tr>
          </thead>
          <tbody class="master">
            <tr *ngFor="let itemPersona of listaPersonas" class="master">
              <td class="master" style="border-right: solid lightgrey 1px;background-color:white">
                  <table class="child" cellspacing="0" cellpading="0" border="0" style="margin:0px;float:left">
                      <tr>
                        <td style="width:40px;text-align:center;background-color:white">{{itemPersona.nro}}. </td>
                        <td style="width:240px;white-space: nowrap" [matTooltip]="itemPersona.nombre !== itemPersona.nombreCorto ? itemPersona.nombre : ''" matTooltipPosition="above">{{itemPersona.nombreCorto}}</td>
                      </tr>
                  </table>
              </td>
              <td class="master">
                    <table class="child" cellspacing="0" cellpading="0" border="0" style="margin:0px;float:left">
                        <tr>
                          <td *ngFor="let itemFecha of listaFechas" style="width:40px;border-right:solid lightgrey 1px">
                            <div *ngFor="let marca of itemPersona.marcas">
                              <div *ngIf="marca.idFecha === itemFecha.idFecha">
                                <div *ngIf="itemFecha.diaHabil && marca.asistio" class="estilo-asistencia pointer" (click)="editarObservacion()"> &#x2713; </div>
                                <div *ngIf="itemFecha.diaHabil && marca.licencia" class="estilo-licencia pointer" (click)="editarObservacion()"> · </div>
                                <div *ngIf="itemFecha.diaHabil && marca.falto" class="estilo-falta pointer" (click)="editarObservacion()"> · </div>
                                <div *ngIf="!itemFecha.diaHabil" class="estilo-inactivo">  </div>
                              </div>
                            </div>
                          </td>
                        </tr>
                    </table>
              </td>
              <td class="master">
                  <table class="child" cellspacing="0" cellpading="0" border="0" style="margin:0px;float:left">
                      <tr>
                          <td class="estilo-asistencia" style="border-right:solid lightgrey 1px">{{itemPersona.total.asistencias}}</td>
                          <td class="estilo-licencia" style="border-right:solid lightgrey 1px">{{itemPersona.total.licencias}}</td>
                          <td class="estilo-falta" style="border-right:solid lightgrey 1px">{{itemPersona.total.faltas}}</td>
                          <td style="width:100px;text-align:center;vertical-align:center;background-color:white">

                            <svg class="btn-report" width="24" height="24" viewBox="0 0 551 551" matTooltip="Reporte individual (Excel)" matTooltipPosition="above" (click)="reporteIndividualEXCEL()">
                              <path d="M488.432,197.019h-13.226v-63.816c0-0.398-0.063-0.799-0.111-1.205c-0.021-2.531-0.833-5.021-2.568-6.992L366.325,3.694c-0.032-0.031-0.063-0.042-0.085-0.076c-0.633-0.707-1.371-1.295-2.151-1.804c-0.231-0.155-0.464-0.285-0.706-0.422c-0.676-0.366-1.393-0.675-2.131-0.896c-0.2-0.053-0.38-0.135-0.58-0.188C359.87,0.119,359.037,0,358.193,0H97.2c-11.918,0-21.6,9.693-21.6,21.601v175.413H62.377c-17.049,0-30.873,13.818-30.873,30.873v160.545c0,17.038,13.824,30.87,30.873,30.87h13.224V529.2c0,11.907,9.682,21.601,21.6,21.601h356.4c11.907,0,21.6-9.693,21.6-21.601V419.302h13.226c17.044,0,30.871-13.827,30.871-30.87v-160.54C519.297,210.832,505.48,197.019,488.432,197.019z M97.2,21.601h250.193v110.51c0,5.967,4.841,10.8,10.8,10.8h95.407v54.108H97.2V21.601z M339.562,354.344v31.324H236.509V220.704h37.46v133.64H339.562z M74.25,385.663l47.73-83.458l-46.019-81.501h42.833l14.439,30.099c4.899,10.03,8.572,18.116,12.49,27.414h0.483c3.926-10.529,7.101-17.872,11.259-27.414l13.954-30.099h42.588l-46.509,80.525l48.961,84.438h-43.081l-14.929-29.858c-6.115-11.507-10.036-20.07-14.684-29.615h-0.49c-3.431,9.55-7.583,18.119-12.722,29.615l-13.711,29.858H74.25V385.663z M453.601,523.353H97.2V419.302h356.4V523.353z M401.963,388.125c-18.837,0-37.446-4.904-46.738-10.04l7.578-30.839c10.04,5.136,25.46,10.283,41.375,10.283c17.139,0,26.188-7.099,26.188-17.867c0-10.283-7.831-16.157-27.659-23.256c-27.411-9.55-45.282-24.722-45.282-48.718c0-28.15,23.498-49.684,62.427-49.684c18.594,0,32.305,3.927,42.093,8.322l-8.322,30.109c-6.607-3.186-18.361-7.834-34.509-7.834c-16.152,0-23.983,7.338-23.983,15.913c0,10.525,9.291,15.18,30.591,23.258c29.125,10.769,42.836,25.936,42.836,49.191C468.545,364.627,447.257,388.125,401.963,388.125z" fill="currentColor"></path>
                            </svg>
                            
                            <span>&nbsp; &nbsp; </span>
                            
                            <svg class="btn-report" width="24" height="24" viewBox="0 0 24 24" matTooltip="Reporte individual (PDF)" matTooltipPosition="above" (click)="reporteIndividualPDF()">
                              <path fill="none" d="M0 0h24v24H0z"/>
                              <path d="M20 2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2V4c0-1.1-.9-2-2-2zm-8.5 7.5c0 .83-.67 1.5-1.5 1.5H9v2H7.5V7H10c.83 0 1.5.67 1.5 1.5v1zm5 2c0 .83-.67 1.5-1.5 1.5h-2.5V7H15c.83 0 1.5.67 1.5 1.5v3zm4-3H19v1h1.5V11H19v2h-1.5V7h3v1.5zM9 9.5h1v-1H9v1zM4 6H2v14c0 1.1.9 2 2 2h14v-2H4V6zm10 5.5h1v-3h-1v3z"/>
                            </svg>

                          </td>
                      </tr>
                  </table>
              </td>
            </tr>
          </tbody>
        </table>
</div>
