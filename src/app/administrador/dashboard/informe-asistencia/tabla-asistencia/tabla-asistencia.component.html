<div class="menu-top" fxLayout="row">
  <div fxLayout="column" fxFlex="50%" fxLayoutAlign="start start">
    <form>
      <div fxLayout="row" fxLayoutAlign="end end">
        <mat-form-field>
          <input type="number" matInput placeholder="Año" required [(ngModel)]="anioAsistencia" name="anioAsistencia" (selectionChange)="actualizar()">
        </mat-form-field>
        <div style="width:10px"></div>
        <mat-form-field>
          <mat-select placeholder="Mes" [(value)]="mesAsistencia" (selectionChange)="actualizar()">
            <mat-option value="01">Enero</mat-option>
            <mat-option value="02">Febrero</mat-option>
            <mat-option value="03">Marzo</mat-option>
            <mat-option value="04">Abril</mat-option>
            <mat-option value="05">Mayo</mat-option>
            <mat-option value="06">Junio</mat-option>
            <mat-option value="07">Julio</mat-option>
            <mat-option value="08">Agosto</mat-option>
            <mat-option value="09">Septiembre</mat-option>
            <mat-option value="10">Octubre</mat-option>
            <mat-option value="11">Noviembre</mat-option>
            <mat-option value="12">Diciembre</mat-option>
          </mat-select>
        </mat-form-field>
        <div style="width:10px"></div>
        <button type="button" mat-raised-button color="primary" (click)="actualizar()">Actualizar</button>
      </div>
    </form>
   </div>
  <div fxLayout="column" fxFlex="50%" fxLayoutAlign="start end">
    <div fxLayout="row" fxLayoutAlign="end end">
      <button type="button" mat-raised-button color="primary" (click)="exportGeneralToExcel()">
        <svg viewBox="0 0 551 551" focusable="false" height="20px">
          <path d="M488.432,197.019h-13.226v-63.816c0-0.398-0.063-0.799-0.111-1.205c-0.021-2.531-0.833-5.021-2.568-6.992L366.325,3.694
            c-0.032-0.031-0.063-0.042-0.085-0.076c-0.633-0.707-1.371-1.295-2.151-1.804c-0.231-0.155-0.464-0.285-0.706-0.422
            c-0.676-0.366-1.393-0.675-2.131-0.896c-0.2-0.053-0.38-0.135-0.58-0.188C359.87,0.119,359.037,0,358.193,0H97.2
            c-11.918,0-21.6,9.693-21.6,21.601v175.413H62.377c-17.049,0-30.873,13.818-30.873,30.873v160.545
            c0,17.038,13.824,30.87,30.873,30.87h13.224V529.2c0,11.907,9.682,21.601,21.6,21.601h356.4c11.907,0,21.6-9.693,21.6-21.601
            V419.302h13.226c17.044,0,30.871-13.827,30.871-30.87v-160.54C519.297,210.832,505.48,197.019,488.432,197.019z M97.2,21.601
            h250.193v110.51c0,5.967,4.841,10.8,10.8,10.8h95.407v54.108H97.2V21.601z M339.562,354.344v31.324H236.509V220.704h37.46v133.64
            H339.562z M74.25,385.663l47.73-83.458l-46.019-81.501h42.833l14.439,30.099c4.899,10.03,8.572,18.116,12.49,27.414h0.483
            c3.926-10.529,7.101-17.872,11.259-27.414l13.954-30.099h42.588l-46.509,80.525l48.961,84.438h-43.081l-14.929-29.858
            c-6.115-11.507-10.036-20.07-14.684-29.615h-0.49c-3.431,9.55-7.583,18.119-12.722,29.615l-13.711,29.858H74.25V385.663z
             M453.601,523.353H97.2V419.302h356.4V523.353z M401.963,388.125c-18.837,0-37.446-4.904-46.738-10.04l7.578-30.839
            c10.04,5.136,25.46,10.283,41.375,10.283c17.139,0,26.188-7.099,26.188-17.867c0-10.283-7.831-16.157-27.659-23.256
            c-27.411-9.55-45.282-24.722-45.282-48.718c0-28.15,23.498-49.684,62.427-49.684c18.594,0,32.305,3.927,42.093,8.322l-8.322,30.109
            c-6.607-3.186-18.361-7.834-34.509-7.834c-16.152,0-23.983,7.338-23.983,15.913c0,10.525,9.291,15.18,30.591,23.258
            c29.125,10.769,42.836,25.936,42.836,49.191C468.545,364.627,447.257,388.125,401.963,388.125z" fill="currentColor"></path>
        </svg>
         Reporte General (Excel)</button>
      <div style="width:10px"></div>
      <button type="button" mat-raised-button color="primary" (click)="printGeneral()"><mat-icon>picture_as_pdf</mat-icon> Reporte General (PDF)</button>
    </div>
  </div>
</div>
<div style="height:10px"></div>
<div class="menu-top" fxLayout="row">
  <div fxLayout="column" fxLayoutAlign="start start">
    <form>
      <div fxLayout="row" fxLayoutAlign="end end">
        <mat-form-field>
          <mat-select placeholder="Turno" [(value)]="idTurno" (selectionChange)="actualizarSelectorGrados()">
            <mat-option *ngFor="let turno of turnos" [value]="turno.id">{{turno.nombre}}</mat-option>
          </mat-select>
        </mat-form-field>
        <div style="width:10px"></div>
        <mat-form-field>
          <mat-select placeholder="Grado" [(value)]="idGrado" (selectionChange)="actualizarSelectorGrupos()">
            <mat-option *ngFor="let grado of grados" [value]="grado.id">{{grado.nombre}}</mat-option>
          </mat-select>
        </mat-form-field>
        <div style="width:10px"></div>
        <mat-form-field>
          <mat-select placeholder="Grupo" [(value)]="idGrupo" (selectionChange)="actualizarSelectorParalelos()">
            <mat-option *ngFor="let grupo of grupos" [value]="grupo.id">{{grupo.nombre}}</mat-option>
          </mat-select>
        </mat-form-field>
        <div style="width:10px"></div>
        <mat-form-field>
          <mat-select placeholder="Paralelo" [(value)]="idParalelo" (selectionChange)="actualizar()">
            <mat-option *ngFor="let paralelo of paralelos" [value]="paralelo.id">{{paralelo.nombre}}</mat-option>
          </mat-select>
        </mat-form-field>
      </div>
    </form>
   </div>
</div>

<mat-progress-bar color="primary" [mode]="loadingMode" value="0"></mat-progress-bar>
<div class="container">
  <table border="0" cellpadding="0px" cellspacing="0px">
    <thead>
      <tr>
        <th class="static-title1" rowspan="2">N°</th>
        <th class="static-title2" rowspan="2" style="min-width:200px">Nombre</th>
        <th class="static-space" rowspan="2"></th>
        <th [attr.colspan]="days.length">{{mesNombre}} {{anioNombre}}</th>
        <th colspan="3">Total</th>
        <th rowspan="2">Reporte</th>
      </tr>
      <tr>
        <th></th>
        <th *ngFor="let day of days">{{day.id}}</th>
        <th style="min-width:20px" matTooltip="Asistencias" matTooltipPosition="above">As</th>
        <th style="min-width:20px" matTooltip="Licencias" matTooltipPosition="above">Li</th>
        <th style="min-width:20px" matTooltip="Faltas" matTooltipPosition="above">Fa</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let persona of dataSource; let i = index">
        <td class="no-select static-data1">{{i + 1}}</td>
        <td class="no-select static-data2" style="text-align:left;padding-left:10px">{{persona.nombre}}</td>
        <td class="no-select static-space"></td>
        <td *ngFor="let day of days" class="{{!day.active ? 'white-td' : ''}}">
          <div *ngIf="!day.active" class="white"></div>
          <div *ngIf="day.active">
            <div *ngIf="persona.marcas.includes(day.id)">
              <div *ngFor="let asistencia of persona.asistencias">
                <div *ngIf="(asistencia.dia === day.id) && (asistencia.estado === 'asistió')      && (asistencia.atrasado === true)"  class="orange pointer" (click)="editarObservacion(day.id, persona, asistencia)" [matTooltip]="asistencia.observacion" matTooltipPosition="above">{{ asistencia.observacion && asistencia.observacion !== '' ? '&#x2713;' : '·' }}</div>
                <div *ngIf="(asistencia.dia === day.id) && (asistencia.estado === 'asistió')      && (asistencia.atrasado === false)" class="green pointer"  (click)="editarObservacion(day.id, persona, asistencia)" [matTooltip]="asistencia.observacion" matTooltipPosition="above">{{ asistencia.observacion && asistencia.observacion !== '' ? '&#x2713;' : '·' }}</div>
                <div *ngIf="(asistencia.dia === day.id) && (!asistencia.estado || asistencia.estado === 'faltó' || asistencia.estado === 'no asistió')" class="red pointer"    (click)="editarObservacion(day.id, persona, asistencia)" [matTooltip]="asistencia.observacion" matTooltipPosition="above">{{ asistencia.observacion && asistencia.observacion !== '' ? '&#x2713;' : '' }}</div>
                <div *ngIf="(asistencia.dia === day.id) && (asistencia.estado === 'con licencia')"                                    class="yellow pointer" (click)="editarObservacion(day.id, persona, asistencia)" [matTooltip]="asistencia.observacion" matTooltipPosition="above">{{ asistencia.observacion && asistencia.observacion !== '' ? '&#x2713;' : '·' }}</div>
              </div>
            </div>
            <div *ngIf="!persona.marcas.includes(day.id)" class="red pointer" (click)="editarObservacion(day.id, persona)"></div>
          </div>
        </td>
        <td class="no-select green">{{persona.totalAsistencias}}</td>
        <td class="no-select yellow">{{persona.totalLicencias}}</td>
        <td class="no-select red">{{persona.totalFaltas}}</td>
        <!-- <td class="no-select yellow">{{persona.totalAtrasos}}</td> -->
        <td class="no-select" style="min-width:100px">
          <button mat-icon-button matTooltip="Reporte individual (Excel)" matTooltipPosition="above" (click)="exportToExcel(persona)">
            <svg viewBox="0 0 551 551" focusable="false" height="20px">
              <path d="M488.432,197.019h-13.226v-63.816c0-0.398-0.063-0.799-0.111-1.205c-0.021-2.531-0.833-5.021-2.568-6.992L366.325,3.694
            		c-0.032-0.031-0.063-0.042-0.085-0.076c-0.633-0.707-1.371-1.295-2.151-1.804c-0.231-0.155-0.464-0.285-0.706-0.422
            		c-0.676-0.366-1.393-0.675-2.131-0.896c-0.2-0.053-0.38-0.135-0.58-0.188C359.87,0.119,359.037,0,358.193,0H97.2
            		c-11.918,0-21.6,9.693-21.6,21.601v175.413H62.377c-17.049,0-30.873,13.818-30.873,30.873v160.545
            		c0,17.038,13.824,30.87,30.873,30.87h13.224V529.2c0,11.907,9.682,21.601,21.6,21.601h356.4c11.907,0,21.6-9.693,21.6-21.601
            		V419.302h13.226c17.044,0,30.871-13.827,30.871-30.87v-160.54C519.297,210.832,505.48,197.019,488.432,197.019z M97.2,21.601
            		h250.193v110.51c0,5.967,4.841,10.8,10.8,10.8h95.407v54.108H97.2V21.601z M339.562,354.344v31.324H236.509V220.704h37.46v133.64
            		H339.562z M74.25,385.663l47.73-83.458l-46.019-81.501h42.833l14.439,30.099c4.899,10.03,8.572,18.116,12.49,27.414h0.483
            		c3.926-10.529,7.101-17.872,11.259-27.414l13.954-30.099h42.588l-46.509,80.525l48.961,84.438h-43.081l-14.929-29.858
            		c-6.115-11.507-10.036-20.07-14.684-29.615h-0.49c-3.431,9.55-7.583,18.119-12.722,29.615l-13.711,29.858H74.25V385.663z
            		 M453.601,523.353H97.2V419.302h356.4V523.353z M401.963,388.125c-18.837,0-37.446-4.904-46.738-10.04l7.578-30.839
            		c10.04,5.136,25.46,10.283,41.375,10.283c17.139,0,26.188-7.099,26.188-17.867c0-10.283-7.831-16.157-27.659-23.256
            		c-27.411-9.55-45.282-24.722-45.282-48.718c0-28.15,23.498-49.684,62.427-49.684c18.594,0,32.305,3.927,42.093,8.322l-8.322,30.109
            		c-6.607-3.186-18.361-7.834-34.509-7.834c-16.152,0-23.983,7.338-23.983,15.913c0,10.525,9.291,15.18,30.591,23.258
            		c29.125,10.769,42.836,25.936,42.836,49.191C468.545,364.627,447.257,388.125,401.963,388.125z" fill="currentColor"></path>
            </svg>
          </button>
          <button mat-icon-button matTooltip="Reporte individual (PDF)" matTooltipPosition="above" (click)="print(persona)"><mat-icon>picture_as_pdf</mat-icon></button>
        </td>
      </tr>
    </tbody>
  </table>
</div>
